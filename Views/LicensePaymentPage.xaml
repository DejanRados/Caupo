<UserControl x:Class="Caupo.Views.LicensePaymentPage"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
             xmlns:wv2="clr-namespace:Microsoft.Web.WebView2.Wpf;assembly=Microsoft.Web.WebView2.Wpf"
             xmlns:local="clr-namespace:Caupo.Views"
             mc:Ignorable="d" 
             d:DesignHeight="450" d:DesignWidth="800">
    <Grid>
        <Grid HorizontalAlignment="Stretch" VerticalAlignment="Top" Height="55" Background="#323232" >
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="0.2*"/>
            </Grid.ColumnDefinitions>
            <Image Source="pack://application:,,,/Images/dsoftlogosmall.png" Width="50" Height="50" Grid.Column="0" HorizontalAlignment="Left" Margin="20,0,0,0"/>
            <Label x:Name="lblApp" Content="Caupo - Licenca" Foreground="#fafafa" FontSize="25" Grid.Column="0" HorizontalAlignment="Center"  VerticalAlignment="Center"/>
            <Label x:Name="lblUlogovaniKorisnik" Content="Ime i prezime" Foreground="#fafafa" FontSize="16" Grid.Column="1" HorizontalAlignment="Right"  VerticalAlignment="Center"/>
            <Button x:Name="CloseButton" Style="{StaticResource CloseButtonStyle}" Click="CloseButton_Click_1"  VerticalAlignment="Top" HorizontalAlignment="Right" Padding="0" Margin="1"  Grid.Column="2" />
        </Grid>
        <Grid>
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="Auto"/>
                <!-- DODATO: Toolbar za WebView -->
                <RowDefinition Height="*"/>
                <RowDefinition Height="Auto"/>
            </Grid.RowDefinitions>

            <!-- Header -->
            <Border Grid.Row="0" Background="#1a202c" Padding="20">
                <StackPanel>
                    <TextBlock Text="KUPOVINA LICENCE" 
                           Foreground="White" 
                           FontSize="24" 
                           FontWeight="Bold"
                           HorizontalAlignment="Center"/>
                    <TextBlock Text="Sigurna online kupovina putem Stripe-a" 
                           Foreground="#a0aec0" 
                           FontSize="14"
                           HorizontalAlignment="Center"
                           Margin="0,5,0,0"/>
                </StackPanel>
            </Border>

            <!-- DODATO: WebView Navigation Toolbar -->
            <Border Grid.Row="1" Background="#2d3748" Padding="10,5" BorderBrush="#4a5568" BorderThickness="0,0,0,1">
                <StackPanel Orientation="Horizontal" HorizontalAlignment="Left">

                    <!-- BACK Button -->
                    <Button x:Name="btnBack" 
                            Content="← Nazad" 
                            Click="BtnBack_Click"
                            Width="80"
                            Height="30"
                            Background="#4a5568"
                            Foreground="White"
                            BorderThickness="0"
                            Visibility="Collapsed"
                            Margin="0,0,10,0">
                        <Button.Style>
                            <Style TargetType="Button">
                                <Setter Property="Cursor" Value="Hand"/>
                                <Setter Property="Template">
                                    <Setter.Value>
                                        <ControlTemplate TargetType="Button">
                                            <Border Background="{TemplateBinding Background}"
                                                    CornerRadius="3">
                                                <ContentPresenter HorizontalAlignment="Center"
                                                                  VerticalAlignment="Center"/>
                                            </Border>
                                        </ControlTemplate>
                                    </Setter.Value>
                                </Setter>
                                <Style.Triggers>
                                    <Trigger Property="IsMouseOver" Value="True">
                                        <Setter Property="Background" Value="#5a6578"/>
                                    </Trigger>
                                    <Trigger Property="IsPressed" Value="True">
                                        <Setter Property="Background" Value="#6a7588"/>
                                    </Trigger>
                                </Style.Triggers>
                            </Style>
                        </Button.Style>
                    </Button>

                    <!-- REFRESH Button -->
                    <Button x:Name="btnRefresh" 
                            Content="⟳ Osveži" 
                            Click="BtnRefresh_Click"
                            Width="80"
                            Height="30"
                            Background="#4299e1"
                            Foreground="White"
                            BorderThickness="0">
                        <Button.Style>
                            <Style TargetType="Button">
                                <Setter Property="Cursor" Value="Hand"/>
                                <Setter Property="Template">
                                    <Setter.Value>
                                        <ControlTemplate TargetType="Button">
                                            <Border Background="{TemplateBinding Background}"
                                                    CornerRadius="3">
                                                <ContentPresenter HorizontalAlignment="Center"
                                                                  VerticalAlignment="Center"/>
                                            </Border>
                                        </ControlTemplate>
                                    </Setter.Value>
                                </Setter>
                                <Style.Triggers>
                                    <Trigger Property="IsMouseOver" Value="True">
                                        <Setter Property="Background" Value="#3182ce"/>
                                    </Trigger>
                                    <Trigger Property="IsPressed" Value="True">
                                        <Setter Property="Background" Value="#2c5282"/>
                                    </Trigger>
                                </Style.Triggers>
                            </Style>
                        </Button.Style>
                    </Button>

                    <!-- Current URL display (optional) -->
                    <TextBlock x:Name="txtCurrentUrl" 
                               Margin="15,0,0,0" 
                               VerticalAlignment="Center"
                               Foreground="#a0aec0"
                               FontSize="12"
                               TextTrimming="CharacterEllipsis"
                               MaxWidth="300"/>

                </StackPanel>
            </Border>

            <!-- WebView Container -->
            <Border Grid.Row="2" BorderThickness="0" Margin="10">
                <Grid>
                    <wv2:WebView2 x:Name="webView" ZoomFactor="0.7"
                        Source="about:blank"/>

                    <!-- Loading Overlay -->
                    <Border x:Name="loadingOverlay" 
                        Background="#80000000" 
                        Visibility="Visible">
                        <StackPanel VerticalAlignment="Center" HorizontalAlignment="Center">
                            <ProgressBar IsIndeterminate="True" 
                                    Width="200" 
                                    Height="20" 
                                    Margin="0,0,0,20"/>
                            <TextBlock Text="Učitavanje platnog prozora..." 
                                   Foreground="White" 
                                   FontSize="16"
                                   HorizontalAlignment="Center"/>
                        </StackPanel>
                    </Border>
                </Grid>
            </Border>

            <!-- Footer with buttons -->
            <Border Grid.Row="3" Background="#f7fafc" Padding="15" BorderBrush="#e2e8f0" BorderThickness="0,1,0,0">
                <StackPanel Orientation="Horizontal" HorizontalAlignment="Right">
                    <Button x:Name="btnClose" 
                        Content="Zatvori" 
                        Click="CloseButton_Click_1"
                        Width="100"
                        Height="35"/>

                    <Button x:Name="btnHelp" 
                        Content="Pomoć"
                        Click="BtnHelp_Click"
                        Width="100"
                        Height="35"
                        Background="#4299e1"
                        Foreground="White"
                        Margin="10,0,0,0"/>
                </StackPanel>
            </Border>
        </Grid>
    </Grid>
</UserControl>